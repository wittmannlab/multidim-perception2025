# Human prefrontal cortex integrates dimensions of perceptual experience

**Authors:** Marco K. Wittmann\*, Cormac Dickson\*, Nicholas Shea, Hakwan Lau, Stephen M. Fleming  
\*equal contribution  
**Date:** October 2025  

---

## Overview
This repository contains MATLAB data and analysis scripts associated with the project  
**_“Human prefrontal cortex integrates dimensions of perceptual experience.”_**

The material includes both behavioural and MRI data and is organized into four major analysis sections:

1. **behav_analysis** – Behavioural data analysis  
2. **fmri_glms** – fMRI analysis of the main experiment (General Linear Models)  
3. **fmri_localiser** – fMRI analysis of the localiser experiment  
4. **fmri_RSA** – Representational Similarity Analysis scripts for the main fMRI experiment  

Each section is self-contained and follows an identical internal structure, forming a transparent and reproducible analysis pipeline.

---

## Folder Structure and Processing Pipeline
Within each of the four analysis sections, subfolders are numbered to indicate the order of processing:

```
1_data  →  2_ana  →  3_out  →  4_plot  →  5_Figs  →  6_Stats
```

### Description of Stages
- **1_data** –  
  Contains raw or minimally processed data, both behavioural and fMRI.  
  Includes Region-of-Interest (ROI) data and whole-brain statistical maps.

- **2_ana** –  
  Analysis scripts that import data from *1_data*, perform core computations, and generate processed datasets.

- **3_out** –  
  Output tables (typically in `.csv` format) produced by the analysis scripts.  
  These tables serve as the *source data* for the figures presented in the manuscript.

- **4_plot** –  
  Plotting scripts that take outputs from *3_out* and produce figures saved in *5_Figs*.

- **5_Figs** –  
  Figures corresponding directly to those shown in the manuscript.  
  Filenames indicate their figure number (e.g., *Figure2C*, *SuppFigure3B*), allowing precise reconstruction of each analysis.

- **6_Stats** –  
  Statistical analyses carried out in *JASP*, using the CSV data generated by the preceding stages.

- **utils** –  
  General utility functions shared across analyses (e.g., colour maps, helper routines).

---

## Usage
All analyses were performed in **MATLAB** (tested with version R2022b or later).  
Paths are defined relative to the project root; before running any script, add the top-level directory to the MATLAB path.

To reproduce results for a given figure:

1. Execute the relevant analysis script in *2_ana* to create the corresponding output files in *3_out*.  
2. Run the matching plotting script in *4_plot* to generate the figure in *5_Figs*.  
3. Cross-reference the filename with the manuscript figure label to identify the relevant analysis pipeline.

---

## Notes
- Scripts were developed and tested on macOS and Linux systems.  
- Statistical analyses in *6_Stats* were performed using **JASP**.  
- Data filenames include timestamps to indicate date of generation.  
